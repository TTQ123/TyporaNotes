**什么是前端的副作用**

```bash
1.在前端开发中，"副作用"通常是指对应用程序状态产生影响的任何操作。这可能包括对全局变量的更改、对数据库的写操作、对用户界面的更新等
2.在React和Vue框架中，副作用通常指的是与组件渲染无关的操作，例如数据获取、订阅事件、手动修改DOM等
```



前端中异步与副作用  https://zhuanlan.zhihu.com/p/633408307?utm_id=0



**Watch 和 WatchEffect**

### watch

`watch` 是一个API，用于监视特定数据的变化，并在数据变化时执行特定的回调函数。它接受要监视的数据源和回调函数，可以选择性地指定一些选项，例如 immediate（是否立即执行回调函数）、deep（是否深度监视对象内部的变化）等。

使用场景：

- 当你需要监视特定数据的变化，并在数据变化时执行自定义的操作时，可以使用 `watch`。
- 监听多个数据的变化，并在它们变化时执行特定的操作。

```javascript
import { watch } from 'vue';

watch(
  () => state.count,
  (newVal, oldVal) => {
    // 当 state.count 变化时执行操作
  }
);
```



### watchEffect

`watchEffect` 也用于追踪数据变化，但它不需要显式地指定要监视的数据源。相反，`watchEffect` 内部会自动追踪其依赖的响应式数据，并在这些数据变化时重新执行其回调函数。

使用场景：

- 当你需要自动追踪响应式数据的变化，并在数据变化时执行特定的操作时，可以使用 `watchEffect`。
- 通常用于创建副作用，比如在模板渲染时自动追踪依赖的数据并进行相应的操作。

```javascript
import { watchEffect } from 'vue';

watchEffect(() => {
  // 自动追踪依赖的数据，并在数据变化时执行操作
  console.log(state.count);
});
```

### 相同点和不同点

**相同点**：

- 都用于追踪响应式数据的变化。
- 都能够在数据变化时执行特定的操作。

**不同点**：

- `watch` 需要显式指定要监视的数据源和回调函数，而 `watchEffect` 内部会自动追踪其依赖的响应式数据。
- `watch` 适用于需要监视特定数据变化并执行自定义操作的场景，而 `watchEffect` 适用于需要自动追踪响应式数据变化并执行操作的场景。



**Watch 和 WatchEffect的执行时机 自动执行和深度监测**

### watch

- **执行时机**：`watch` 的回调函数在监视的数据变化后被调用。它允许你指定何时调用回调函数，比如在初始化时立即执行（通过设置 `immediate: true` 选项）或者在监视的数据变化后延迟执行。
- **自动执行**：默认情况下，`watch` 不会在初始化时自动执行其回调函数，除非你显式地设置了 `immediate: true` 选项。
- **深度监测**：可以通过设置 `deep: true` 选项来进行深度监测，以便监视对象内部的变化。

### watchEffect

- **执行时机**：`watchEffect` 的回调函数在创建时立即执行一次，并在其内部依赖的响应式数据变化时再次执行。
- **自动执行**：`watchEffect` 在初始化时会自动执行其回调函数，并且会在其内部依赖的响应式数据变化时自动重新执行。
- **深度监测**：`watchEffect` 内部会自动进行深度监测，以便追踪其依赖的响应式数据的变化。